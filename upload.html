<form id="file-form" action="http://localhost:3000/beats/upload" method="POST">
    <input type="file" id="file-select" name="uploads" multiple />
    <button type="submit" id="upload-button">Upload</button>
</form>

<script>
    var form = document.getElementById('file-form');
    var fileSelect = document.getElementById('file-select');
    var uploadButton = document.getElementById('upload-button');
    form.onsubmit = function (event) {
        event.preventDefault();

        // Update button text.
        uploadButton.innerHTML = 'Uploading...';

        // Get the selected files from the input.
        var files = fileSelect.files;
        // Create a new FormData object.
        var formData = new FormData();

        // Loop through each of the selected files.
        for (var i = 0; i < files.length; i++) {
            var file = files[i];

            // Add the file to the request.
            formData.append('uploads', file, file.name);
        }

        // formData.append("body", JSON.stringify(params));
        formData.append("name", "beat99");
        formData.append("tempo", 155);
        formData.append("public", true);

        // Set up the request.
        var xhr = new XMLHttpRequest();
        // Open the connection.
        xhr.open('POST', 'http://localhost:3000/beats/uploads', true);

        // Add headers
        // xhr.setRequestHeader("Content-Type", "application/json");
        xhr.setRequestHeader("Authorization",
            "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhdmVsbGFyIiwic3ViIjoiNWM1ZDNmZTc4NDYyMzk0ODM0OThhYmZhIiwiaWF0IjoxNTQ5NzQ2MjUwNjg5LCJleHAiOjE1NDk4MzI2NTA2ODl9._4lAMa46k_jHC-PLiqBw91qx8icK0-it4qFEkBhBihQ"
            );

        // Set up a handler for when the request finishes.
        xhr.onload = function () {
            if (xhr.status === 200 || xhr.status === 201) {
                // File(s) uploaded.
                uploadButton.innerHTML = 'Upload';
            } else {
                alert('An error occurred!');
            }
        };
        // Send the Data.
        xhr.send(formData);
    }
</script>